<html>
    <head>
        <title>Vue Filters</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.4/vue.js"></script>
    </head>

    <body>
        <div class="container">
            <h1>Let's hear some stories! ({{famous.length}})</h1>
            <div>
                <h3>Famous Stories</h3>
                <ul class="list-group">
                    <li v-for="story in famous" class="list-group-item">
                        {{story.writer}} said "{{story.plot}}" (Upvotes: {{story.upvotes}})
                    </li>
                </ul>
                <button @click="order = order * -1">Reverse Order</button>
                <h3>Alex's stories</h3>
                <ul class="list-group">
                    <li v-for="story in storiesBy('Alex')" class="list-group-item">
                        {{story.writer}} said "{{story.plot}}""
                        and upvoted {{story.upvotes}} times.
                    </li>
                </ul>
                <h3>John's stories</h3>
                <ul class="list-group">
                    <li v-for="story in storiesBy('John')" class="list-group-item">
                        {{story.writer}} said "{{story.plot}}""
                        and upvoted {{story.upvotes}} times.
                    </li>
                </ul>
                <div class="form-group">
                    <label for="query">What are you looking for?</label>
                    <input v-model="query" name="query" class="form-control">                    
                </div>
                <h3>Search Results:</h3>
                <ul class="list-group" v-if="query">
                    <li v-for="story in searchResult" class="list-group-item">
                        {{story.writer}} said "{{story.plot}}"
                    </li>
                </ul>
            </div>

            <h1>Real identities of Super Heroes!</h1>
            <ul class="list-group">
                <li v-for="hero in heroes" class="list-group-item">
                    {{hero | snitch}}
                </li>
            </ul>

            <!-- display data for debugging -->
            <pre>
                <code>
                    {{$data}}
                </code>
            </pre>
        </div>
    </body>
    <script>
        Vue.filter('snitch', function (hero) {
            return hero.secretId + ' is ' +
                hero.firstname + ' ' +
                hero.lastname + ' in real life!';
        });

        new Vue({
            el: ".container",
            data: {
                stories: [
                    { 
                        plot: "I crashed my car today!",
                        writer: "Alex",
                        upvotes: 28
                    },
                    {
                        plot: "Yesterday, someone store my bag!",
                        writer: "John",
                        upvotes: 8
                    },
                    {
                        plot: "Someone ate my chocolate ...",
                        writer: "John",
                        upvotes: 51
                    },
                    {
                        plot: "I ate someone's chocolate!",
                        writer: "Alex",
                        upvotes: 74
                    },
                ],
                query: "",
                order: 1,
                heroes: [
                    { firstname: "Bruce", lastname: "Wayne", secretId: "Batman" },
                    { firstname: "Clark", lastname: "Kent", secretId: "Superman" },
                    { firstname: "Jay", lastname: "Grrick", secretId: "Flash" },
                    { firstname: "Peter", lastname: "Parker", secretId: "Spider-Man" },
                ]
            },
            computed: {
                famous: function() {
                    return this.stories.filter((story) => {
                        return story.upvotes > 25;
                    }).sort((s1, s2) => {
                        return (s2.upvotes - s1.upvotes) * this.order;
                    });
                },
                searchResult: function () {
                    var query = this.query;
                    return this.stories.filter((story) => {
                        return story.plot.includes(query);
                    });
                }
            },
            methods: {
                storiesBy: function (writer) {
                    return this.stories.filter(function (story) {
                        return story.writer == writer;
                    });
                }
            }
        })
    </script>
</html>